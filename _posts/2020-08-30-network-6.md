---
layout: post
title:  " Session과 Cookie"
date:   2020-08-30
desc: "Session과 Cookie의 차이와 동작원리"
keywords: "Network"
categories: [Network]
tags: [network]
icon: icon-html
---

Session과 Cookie의 차이와 동작원리
=====

<br/>

## 쿠키(Cookie)
+ ### 쿠키는 서버가 사용자의 웹 브라우저 저장하는 데이터이다.
+ ### 쿠키는 key-value형태로 String으로 이루어져 있다.
+ ### 4KB이상 저장할 수 없다.

> 브라우저 마다 저장되는 쿠키가 다르다. 서버에서는 브라우저가 다르면 다른 사용자로 인식한다.

## 쿠키 동작 순서
1. ### 클라이언트가 서버에 요청을 하면 서버가 응답할 때 쿠키에 저장하고자 하는 정보를 set-Cookie를 통해
### 해더에 담아 함께 전달한다.
> Set-Cookie:<cookie-name><cookie-value>
<br/>

2. ### 클라이언트는 서버로 전송하는 모든 요청에 현재 브라우저에 저장된 모든 쿠키를 Header의 cookie로 전달한다.
> Cookie: <cookie-name><cookie-value>

<br/>

### 서버가 쿠키와 함께 아래와 같은 응답을 클라이언트에게 전달했다면
``` c
HTTP/1.0 200 OK
Content-type: text/html
Set-Cookie: yummy_cookie=choco
Set-Cookie: tasty_cookie=strawberry

```

<br/>

### 이후에는 해당 클라이언트는 매번 저장된 쿠키를 헤더에 포함시켜 요청을 보내게 된다.

``` c
GET /sample_page.html HTTP/1.1
Host: www.example.org
Cookie: yummy_cookie=choco; tasty_cookie=strawberry
```


## 세션 동작 순서

### 1. 클라이언트가 서버에 처음으로 Request를 보냄 (첫 요청이기 때문에 session id가 존재하지 않음)
### 2. 서버에서는 session id 쿠키 값이 없는 것을 확인하고 새로 발급해서 응답
### 3. 이후 클라이언트는 전달받은 session id 값을 매 요청마다 헤더 쿠키에 넣어서 요청
### 4. 서버는 session id를 확인하여 사용자를 식별
### 5. 클라이언트가 로그인을 요청하면 서버는 session을 로그인한 사용자 정보로 갱신하고 새로운 session id를 발급하여 응답
### 6. 이후 클라이언트는 로그인 사용자의 session id 쿠키를 요청과 함께 전달하고 서버에서도 로그인된 사용자로 식별 가능
### 7. 클라이언트 종료 (브라우저 종료) 시 session id 제거, 서버에서도 세션 제거